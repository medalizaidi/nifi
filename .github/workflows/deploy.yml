name: NiFi CI/CD Pipeline

on:
  repository_dispatch:
    types: [flow-updated]
  
  workflow_dispatch:
  
  push:
    branches:
      - main

jobs:
  test-dispatch:
    name: Test Dispatch Event
    runs-on: self-hosted
    
    steps:
      - name: Show event details
        run: |
          echo "Event name: ${{ github.event_name }}"
          echo "Event action: ${{ github.event.action }}"
          
          if [ "${{ github.event_name }}" == "repository_dispatch" ]; then
            echo "âœ… Repository dispatch event received!"
            echo "Event type: ${{ github.event.client_payload }}"
          fi
      
      - name: Dummy deployment
        run: |
          echo "ðŸš€ Mock deployment triggered"
          echo "This proves the dispatch event is working"